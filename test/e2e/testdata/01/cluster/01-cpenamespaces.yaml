# This file contains the 'cpe' and 'cpe-system' namespaces that are a prerequistie for other files to deploy. 
# The reason that 'cpe' and 'cpe-system' are in a separate step and not on-the-fly is twofold;
# - it makes testing of individual files easier (multiple  files deploy in these namespace).
# - it allows one to delete for example 05-xyz.yaml without risk of losing resource that are created by applications/operators (as would happen when deleting a namespace)


steps:
- tmplt: ../tpl/namespace.yaml
  values:
    name: kube-system
    amend: true
    opaExcluded: true 
# Note: this doesn't have effect on AKS until https://github.com/Azure/AKS/issues/879 is fixed.
# See opa-validating-webhook ValidatingWebhookConfiguration for the work-a-round.

- tmplt: ../tpl/namespace.yaml
  values:
    name: cpe-system
    opaExcluded: true 
    
- tmplt: ../tpl/namespace.yaml
  values:
    name: cpe
    opaExcluded: true 



# default values for all template expansions (also see values.yaml)
defaults:
  gitops: k8s-clusters-addons.cpenamespaces
  k8sOwner: example
  k8sCostcenter: tbd